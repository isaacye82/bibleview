<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matthew 17: Glory & Valley | 马太福音第十七章</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Noto+Sans+SC:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap');

        :root {
            /* Glory Gold - Transfiguration, Divinity */
            --theme-primary: #eab308; 
            /* Mountain White/Cloud - Purity, Revelation */
            --theme-accent: #fafafa;
            /* Valley Blue - Struggles, Worldly Reality */
            --theme-dark: #1e3a8a;
            /* Background */
            --theme-bg: #fffbeb;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: var(--theme-bg);
            color: #422006;
        }

        .en-text {
            font-family: 'Playfair Display', serif;
        }

        h1, h2, h3, .serif {
            font-family: 'Noto Serif SC', serif;
        }

        /* Navigation Styling */
        .nav-btn {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .active-tab {
            color: #854d0e; /* Dark Gold */
            font-weight: 700;
        }
        .active-tab::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: #854d0e;
            border-radius: 2px;
        }

        /* Card Styling */
        .verse-card {
            background-color: white;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
            border: 1px solid #fde047; /* Yellow 300 */
        }
        .verse-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px -5px rgba(234, 179, 8, 0.2);
            border-left-color: var(--theme-primary);
        }

        .academic-box {
            background-color: #f8fafc; /* Slate 50 */
            border-left: 3px solid #64748b; /* Slate 500 */
            color: #334155;
        }
        
        .devotional-box {
            background-color: #fff7ed; /* Orange 50 */
            border-left: 3px solid #f97316; /* Orange 500 */
            color: #9a3412;
        }

        /* Transfiguration Glow Animation */
        .glory-container {
            position: relative;
            height: 240px;
            background: linear-gradient(to top, #1e3a8a 0%, #0f172a 40%, #000000 100%);
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #3b82f6;
        }

        .figure {
            position: relative;
            font-size: 3rem;
            color: #94a3b8; /* Dim initially */
            z-index: 10;
            transition: all 2s ease-in-out;
        }

        .cloud {
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0) 60%);
            opacity: 0;
            transition: opacity 2s ease-in-out;
            pointer-events: none;
        }

        /* Active State */
        .transfigured .figure {
            color: #ffffff;
            text-shadow: 0 0 20px #fbbf24, 0 0 40px #f59e0b, 0 0 60px #ffffff;
            transform: scale(1.1);
        }
        
        .transfigured .cloud {
            opacity: 0.7;
            animation: cloud-pulse 4s infinite alternate;
        }

        @keyframes cloud-pulse {
            0% { transform: scale(1); opacity: 0.6; }
            100% { transform: scale(1.1); opacity: 0.8; }
        }

        /* Mustard Seed Animation */
        .seed-container {
            height: 60px;
            background-color: #f0fdf4;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            border: 1px solid #bbf7d0;
            margin-top: 10px;
        }
        
        .mountain {
            position: absolute;
            right: 20px;
            bottom: 0;
            width: 0; 
            height: 0; 
            border-left: 30px solid transparent;
            border-right: 30px solid transparent;
            border-bottom: 50px solid #475569;
            transition: transform 1s ease-in-out;
        }
        
        .seed-dot {
            position: absolute;
            left: 20px;
            bottom: 25px;
            width: 6px;
            height: 6px;
            background-color: #ca8a04;
            border-radius: 50%;
            transition: transform 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .move-mt .seed-dot { transform: scale(3) translateX(50px); }
        .move-mt .mountain { transform: translateX(200px); opacity: 0; }

        /* Scrollbar */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="bg-white/95 backdrop-blur-md shadow-md sticky top-0 z-50 border-b border-yellow-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-24 sm:h-20 items-center">
                <div class="flex items-center">
                    <span class="text-2xl font-bold text-yellow-900 serif flex flex-col leading-tight">
                        <span><i class="fas fa-mountain mr-2 text-yellow-600"></i> 马太福音 17章</span>
                        <span class="text-xs text-yellow-700 en-text font-normal ml-8">Matthew Chapter 17</span>
                    </span>
                </div>
                <div class="flex space-x-4 sm:space-x-8 items-center overflow-x-auto no-scrollbar">
                    <button onclick="navigate('dashboard')" id="nav-dashboard" class="nav-btn active-tab px-2 py-2 text-sm text-center shrink-0">
                        山上与山下 <br><span class="text-[10px] uppercase opacity-70 en-text">Mountain & Valley</span>
                    </button>
                    <button onclick="navigate('study')" id="nav-study" class="nav-btn px-2 py-2 text-sm text-slate-500 hover:text-yellow-700 text-center shrink-0">
                        逐节研读 <br><span class="text-[10px] uppercase opacity-70 en-text">Study</span>
                    </button>
                    <button onclick="navigate('methodology')" id="nav-methodology" class="nav-btn px-2 py-2 text-sm text-slate-500 hover:text-yellow-700 text-center shrink-0">
                        方法论总结 <br><span class="text-[10px] uppercase opacity-70 en-text">Methodology</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="app-content" class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        <!-- Injected via JS -->
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 text-slate-400 mt-auto">
        <div class="max-w-7xl mx-auto py-8 px-4 text-center">
            <p class="text-lg font-serif italic text-yellow-200 mb-1">"这是我的爱子，我所喜悦的。你们要听他！"</p>
            <p class="text-sm italic text-slate-500 mb-2 en-text">"This is my beloved Son, with whom I am well pleased; listen to him."</p>
            <p class="text-xs opacity-70">马太福音第十七章中英对照研经报告 | Glory & Faith</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- Data Store ---
        const chapterData = {
            intro: {
                title: "高山的荣耀与深谷的现实",
                title_en: "Glory on the Mountain & Reality in the Valley",
                summary_zh: "马太福音第17章呈现了基督徒经历中最具张力的两个场景：在'高山'上，耶稣显出属天的荣耀，父神确认祂的身份；在'山下'，门徒面对被鬼附的孩子却无能为力。这一章从登山变像开始，不仅是为了坚固门徒面对即将到来的十字架（谈论耶稣去世的事），也是为了确立'只听耶稣'的至高权柄。随后，耶稣教导了信心的力量（芥菜种）和神儿女的自由（纳税神迹）。",
                summary_en: "Matthew 17 presents two contrasting scenes of Christian experience: the 'High Mountain', where Jesus reveals celestial glory and the Father confirms His identity; and the 'Valley', where disciples fail to heal a demon-possessed boy. The chapter begins with the Transfiguration, strengthening disciples for the coming Cross and establishing the supreme authority of 'Listen to Him'. Jesus then teaches on the power of faith (mustard seed) and the freedom of sonship (temple tax).",
                concepts: [
                    { title: "变了形象", title_en: "Transfigured", greek: "Metamorphoō", color: "text-yellow-600", desc_zh: "指本质的完全改变或显露。英文Metamorphosis（蜕变）由此而来。", desc_en: "Complete change of form or revelation of essence. Root of 'Metamorphosis'." },
                    { title: "信心", title_en: "Faith", greek: "Pistis", color: "text-amber-700", desc_zh: "不是心理自信，而是对神的依赖。即使像芥菜种一样小，若是有生命力的，也是强大的。", desc_en: "Not self-confidence, but dependence on God. Powerful if alive, even if small." },
                    { title: "绊倒", title_en: "Offense", greek: "Skandalon", color: "text-slate-600", desc_zh: "陷阱或触发器。耶稣纳税是为了避免给他人造成不必要的信仰障碍。", desc_en: "Trap or trigger. Jesus paid tax to avoid putting an unnecessary stumbling block." }
                ]
            },
            sections: [
                {
                    id: "transfiguration",
                    title: "壹 · 登山变像：预尝国度荣耀 (17:1-8)",
                    title_en: "The Transfiguration: Foretaste of Glory",
                    desc: "只听耶稣 | Listen to Him Only",
                    verses: [
                        {
                            ref: "17:2-5",
                            text_zh: "就在他们面前变了形象，脸面明亮如日头，衣裳洁白如光...有声音从云彩里出来说：'这是我的爱子...你们要听他！'",
                            text_en: "And he was transfigured before them, and his face shone like the sun, and his clothes became white as light... a voice from the cloud said, 'This is my beloved Son... listen to him!'",
                            academic: {
                                title: "律法与先知的终结与成全 (Law & Prophets)",
                                content_zh: "摩西代表律法，以利亚代表先知。他们的显现表明旧约的一切都是指向耶稣。彼得提议'搭三座棚'，试图将耶稣与摩西、以利亚并列。但父神打断了他，云彩（Shekinah，神的同在）遮盖他们，指出耶稣是独特的'爱子'。结论是'不见一人，只见耶稣'。这意味着耶稣超越并成全了旧约体系，现在祂是唯一的权威。",
                                content_en: "Moses represents Law; Elijah, Prophets. Their appearance shows the OT points to Jesus. Peter's offer to build 'three tents' tried to equalize Jesus with them. The Father interrupted via the Cloud (Shekinah), isolating Jesus as the unique 'Beloved Son'. The conclusion 'saw no one but Jesus' signifies He supersedes and fulfills the OT; He is now the sole Authority."
                            },
                            devotional: {
                                title: "不要停留在山上 (Don't Stay on the Mountain)",
                                content_zh: "我们都喜欢'山顶经历'（特别的特会、感动的祷告），想像彼得一样搭棚住在那里的荣耀中。但耶稣带他们上山是为了让他们有力气下山面对苦难。属灵的高峰体验不是为了让我们逃避现实，而是为了让我们在山下的黑暗中仍能记得山上的光。荣耀是为十字架做准备的。",
                                content_en: "We love 'mountaintop experiences' (retreats, intense prayer) and want to 'build tents' there like Peter. But Jesus took them up to empower them to go down. Spiritual peaks aren't for escaping reality, but for remembering the Light when in the valley's darkness. Glory prepares us for the Cross."
                            }
                        }
                    ]
                },
                {
                    id: "epileptic",
                    title: "贰 · 山下的失败：无能的门徒 (17:14-21)",
                    title_en: "Failure in the Valley: Powerless Disciples",
                    desc: "这一代的两极：不信与小信 | Unbelief vs Little Faith",
                    verses: [
                        {
                            ref: "17:17, 20",
                            text_zh: "耶稣说：'嗳！这又不信又悖谬的世代啊...' '是因你们的信心小。...若有信心像一粒芥菜种...'",
                            text_en: "Jesus answered, 'O faithless and twisted generation...' 'Because of your little faith... if you have faith like a grain of mustard seed...'",
                            academic: {
                                title: "不信与小信的区别 (Faithless vs Little Faith)",
                                content_zh: "耶稣称群众为'不信'（Apistos，完全没有信心），称门徒为'小信'（Oligopistia，信心贫乏或未运作）。门徒赶不出鬼，可能是因为他们依赖过去的经验（太10章曾被授权），而非当下的依赖。'芥菜种'的比喻不在于信心的'量'（大小），而在于信心的'质'（生命力）。只要有真生命，哪怕微小，连接于神也能移山。",
                                content_en: "Jesus calls the crowd 'faithless' (Apistos) but disciples 'little faith' (Oligopistia). Disciples likely failed by relying on past experience (authorized in Ch 10) rather than present dependence. The 'Mustard Seed' metaphor isn't about 'quantity' (size) but 'quality' (vitality). Even microscopic faith, if alive and connecting to God, moves mountains."
                            },
                            devotional: {
                                title: "面对你的无能 (Facing Your Powerlessness)",
                                content_zh: "当我们在生活或事奉中遭遇'赶不出去'的难题时，耶稣不仅指出了我们的'小信'，更指出了出路（有些古卷提及'祷告禁食'）。这提醒我们：属灵的权柄不能像存钱一样'储存'起来随时取用，它需要通过持续的、依靠神的祷告来维持。承认无能，是能力的开始。",
                                content_en: "When we face stubborn problems we 'cannot cast out', Jesus points to 'little faith' and the remedy (prayer/fasting in some MSS). Spiritual authority cannot be 'stored' like cash; it must be maintained through continuous, dependent prayer. Admitting powerlessness is the beginning of power."
                            }
                        }
                    ]
                },
                {
                    id: "tax",
                    title: "叁 · 圣殿税的神迹：儿子的自由 (17:24-27)",
                    title_en: "Miracle of the Temple Tax: Freedom of Sons",
                    desc: "不绊倒人的智慧 | Wisdom Not to Offend",
                    verses: [
                        {
                            ref: "17:25-27",
                            text_zh: "...世上的君王向谁征收关税、丁税？...既然如此，儿子就可以免税了。但恐怕触犯他们...往海边去钓鱼...",
                            text_en: "...From whom do kings of the earth take toll or tax?... Then the sons are free. However, not to give offense to them... go to the sea and cast a hook...",
                            academic: {
                                title: "神学上的豁免与爱心的顺服 (Exemption & Submission)",
                                content_zh: "这半舍客勒是给耶和华的赎罪银（出30:13）。作为神的儿子，耶稣是圣殿的主人，理应豁免纳税（儿子不给父亲交税）。但为了不让那些不懂祂身份的人'跌倒'（Offend），祂选择了顺服。这个神迹（鱼口得钱）本身证明了祂确实是万物的主，有资格不交税，但祂却用这笔钱同时付了自己和彼得的税。这是'降卑'的极佳注脚。",
                                content_en: "The half-shekel was ransom money for Yahweh (Ex 30). As God's Son, Jesus is Lord of the Temple and exempt (sons don't pay kings). But to avoid 'offending' those ignorant of His identity, He submits. The miracle (coin in fish) proves He IS the Lord of creation (exempt), yet He uses it to pay for Himself and Peter. A perfect note of 'condescension'."
                            },
                            devotional: {
                                title: "自由是为了爱 (Freedom for Love)",
                                content_zh: "真理叫我们得自由，但爱心叫我们为了他人放弃权利。有时候，坚持'我是对的'或'我有权利'会绊倒软弱的人。耶稣教导我们：作为神的儿女，我们在灵里是完全自由的，但为了福音的缘故，我们甘愿受约束。你愿意为了不绊倒人，而放弃你合法的权利吗？",
                                content_en: "Truth frees us, but Love waives rights for others. Sometimes insisting on 'I am right' or 'my rights' stumbles the weak. Jesus teaches: As God's children, we are spiritually free, but for the Gospel, we voluntarily submit. Are you willing to forfeit your legitimate rights to avoid causing offense?"
                            }
                        }
                    ]
                }
            ]
        };

        // --- State ---
        let appState = {
            view: 'dashboard',
            studyFilter: 'all',
            isTransfigured: false
        };

        // --- Init ---
        document.addEventListener('DOMContentLoaded', () => {
            renderDashboard();
        });

        // --- Navigation ---
        function navigate(view) {
            appState.view = view;
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active-tab');
                btn.classList.add('text-slate-500');
            });
            document.getElementById(`nav-${view}`).classList.add('active-tab');
            document.getElementById(`nav-${view}`).classList.remove('text-slate-500');

            if (view === 'dashboard') renderDashboard();
            if (view === 'study') renderStudy();
            if (view === 'methodology') renderMethodology();
            window.scrollTo(0,0);
        }

        // --- Interactive Functions ---
        function toggleTransfiguration() {
            appState.isTransfigured = !appState.isTransfigured;
            const container = document.getElementById('glory-vis');
            const btn = document.getElementById('glory-btn');
            const text = document.getElementById('glory-text');
            
            if (appState.isTransfigured) {
                container.classList.add('transfigured');
                btn.innerHTML = '<i class="fas fa-undo mr-2"></i> 下山 (Descend)';
                btn.className = "px-6 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-full transition shadow-lg";
                text.innerHTML = '<span class="text-yellow-400 font-serif text-lg">"这是我的爱子...你们要听他！"</span>';
            } else {
                container.classList.remove('transfigured');
                btn.innerHTML = '<i class="fas fa-mountain mr-2"></i> 上山变像 (Ascend)';
                btn.className = "px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-full transition shadow-lg";
                text.innerHTML = '<span class="text-slate-400 text-sm">点击按钮见证荣耀 (Click to witness Glory)</span>';
            }
        }

        function moveMountain() {
            const container = document.getElementById('seed-box');
            container.classList.add('move-mt');
            setTimeout(() => {
                container.classList.remove('move-mt');
            }, 3000);
        }

        // --- Renders ---
        function renderDashboard() {
            const container = document.getElementById('app-content');
            container.innerHTML = `
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-8 animate-fade-in">
                    <!-- Intro -->
                    <div class="lg:col-span-8 bg-white p-8 rounded-xl shadow-lg border-t-4 border-yellow-500">
                        <div class="flex items-center mb-4">
                            <span class="bg-yellow-100 text-yellow-800 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide mr-3">Glory</span>
                            <h2 class="text-3xl font-bold serif text-yellow-900">${chapterData.intro.title}</h2>
                        </div>
                        <h3 class="text-lg text-slate-400 font-serif italic mb-4 en-text">${chapterData.intro.title_en}</h3>
                        <p class="text-slate-600 leading-relaxed mb-4 text-lg border-l-4 border-yellow-200 pl-4">${chapterData.intro.summary_zh}</p>
                        <p class="text-slate-500 leading-relaxed text-sm italic en-text border-l-4 border-slate-200 pl-4">${chapterData.intro.summary_en}</p>
                        
                        <!-- Concept Cards -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-8">
                            ${chapterData.intro.concepts.map(c => `
                                <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 flex flex-col items-center text-center transition hover:bg-yellow-50 group">
                                    <h4 class="font-bold ${c.color} text-lg mb-1 group-hover:scale-105 transition">${c.title}</h4>
                                    <p class="text-xs text-slate-400 font-serif mb-1 en-text">${c.title_en}</p>
                                    <p class="text-xs text-slate-500 font-mono mb-2">${c.greek}</p>
                                    <p class="text-xs text-slate-600 mb-1">${c.desc_zh}</p>
                                    <p class="text-[10px] text-slate-400 italic en-text">${c.desc_en}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Visual Sidebar: Transfiguration Glow -->
                    <div class="lg:col-span-4 bg-slate-900 p-6 rounded-xl shadow-lg flex flex-col border border-slate-700 relative overflow-hidden">
                         <h3 class="text-xl font-bold mb-1 text-center text-yellow-200">变像光辉</h3>
                         <p class="text-xs text-slate-400 mb-4 text-center en-text uppercase tracking-widest">Transfiguration Simulator</p>
                         
                         <div id="glory-vis" class="glory-container mb-4">
                            <div class="cloud"></div>
                            <div class="figure"><i class="fas fa-user"></i></div>
                         </div>
                         
                         <div id="glory-text" class="text-center h-8 mb-2 flex items-center justify-center">
                            <span class="text-slate-400 text-sm">点击按钮见证荣耀 (Click to witness Glory)</span>
                         </div>

                         <div class="flex justify-center">
                            <button id="glory-btn" onclick="toggleTransfiguration()" class="px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-full transition shadow-lg font-bold text-sm">
                                <i class="fas fa-mountain mr-2"></i> 上山变像 (Ascend)
                            </button>
                         </div>
                    </div>
                </div>

                <!-- Feature: Faith & Freedom -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <!-- Mustard Seed -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-green-200">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold text-slate-700"><i class="fas fa-seedling text-green-600 mr-2"></i> 芥菜种的信心</h3>
                            <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">Matt 17:20</span>
                        </div>
                        <p class="text-xs text-slate-500 mb-4">信心不在乎大小，在乎生命力。点击测试移山。</p>
                        <div id="seed-box" class="seed-container cursor-pointer" onclick="moveMountain()">
                            <div class="seed-dot"></div>
                            <div class="mountain"></div>
                        </div>
                        <p class="text-[10px] text-center text-slate-400 mt-2 italic en-text">"Nothing will be impossible for you."</p>
                    </div>

                    <!-- Temple Tax -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-blue-200">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold text-slate-700"><i class="fas fa-fish text-blue-600 mr-2"></i> 鱼口的税银</h3>
                            <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">Matt 17:27</span>
                        </div>
                        <div class="flex items-center gap-4">
                            <div class="text-4xl text-blue-500"><i class="fas fa-coins"></i></div>
                            <div>
                                <h4 class="font-bold text-slate-800 text-sm">儿子的自由 (Sonship)</h4>
                                <p class="text-xs text-slate-500 mt-1">虽然免税，却为了爱而付税。</p>
                                <p class="text-[10px] text-slate-400 italic en-text">Free, but submitting to serve.</p>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-blue-50 text-xs text-slate-600">
                            <strong>原则：</strong> 既然你是王的孩子，你就不用通过纳税来证明身份。但为了不绊倒人，我们放弃权利。
                        </div>
                    </div>
                </div>
            `;
        }

        function renderStudy() {
            const container = document.getElementById('app-content');
            
            // Filter Controls
            const filterHTML = `
                <div class="sticky top-20 z-40 bg-[#fffbeb]/95 backdrop-blur py-4 mb-6 border-b border-yellow-200">
                    <div class="flex justify-between items-center max-w-5xl mx-auto">
                        <h2 class="text-2xl font-bold text-yellow-900 serif">逐节研读室 <span class="text-base font-normal text-slate-400 en-text ml-2">Verse by Verse Study</span></h2>
                        <div class="flex bg-white rounded-lg shadow-sm p-1 border border-yellow-200">
                            <button onclick="updateFilter('all')" class="px-4 py-1.5 rounded text-sm transition ${appState.studyFilter === 'all' ? 'bg-yellow-600 text-white font-bold' : 'text-slate-500 hover:bg-slate-100'}">全部 All</button>
                            <button onclick="updateFilter('academic')" class="px-4 py-1.5 rounded text-sm transition ${appState.studyFilter === 'academic' ? 'bg-slate-600 text-white font-bold' : 'text-slate-500 hover:bg-slate-100'}">经文含义 Exegesis</button>
                            <button onclick="updateFilter('devotional')" class="px-4 py-1.5 rounded text-sm transition ${appState.studyFilter === 'devotional' ? 'bg-orange-600 text-white font-bold' : 'text-slate-500 hover:bg-slate-100'}">灵修应用 Devotional</button>
                        </div>
                    </div>
                </div>
            `;

            let sectionsHTML = '';
            chapterData.sections.forEach(section => {
                sectionsHTML += `
                    <div class="max-w-5xl mx-auto mb-16">
                        <div class="flex items-center mb-6 pl-2 border-l-4 border-yellow-600">
                            <div class="pl-4">
                                <h3 class="text-2xl font-bold text-slate-800">${section.title}</h3>
                                <p class="text-sm text-yellow-700 font-serif italic mt-1 en-text">${section.title_en} | ${section.desc}</p>
                            </div>
                        </div>
                        
                        <div class="space-y-6">
                            ${section.verses.map(verse => createVerseCard(verse)).join('')}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = filterHTML + sectionsHTML;
        }

        function createVerseCard(verse) {
            // Safety checks
            const academicTitle = verse.academic ? verse.academic.title : "Title Missing";
            const academicContentZh = verse.academic ? verse.academic.content_zh : "Content missing";
            const academicContentEn = verse.academic ? verse.academic.content_en : "Content missing";
            
            const devotionalTitle = verse.devotional ? verse.devotional.title : "Title Missing";
            const devotionalContentZh = verse.devotional ? verse.devotional.content_zh : "Content missing";
            const devotionalContentEn = verse.devotional ? verse.devotional.content_en : "Content missing";

            return `
                <div class="verse-card rounded-lg shadow-sm overflow-hidden mb-6 group">
                    <!-- Verse Text -->
                    <div class="bg-gradient-to-r from-yellow-50 to-white p-5 border-b border-yellow-100">
                        <span class="inline-block px-2 py-0.5 bg-yellow-100 text-yellow-800 text-xs font-bold rounded mb-2 font-mono border border-yellow-200">${verse.ref}</span>
                        <p class="text-slate-800 font-serif text-lg leading-relaxed group-hover:text-yellow-900 transition-colors mb-2">"${verse.text_zh}"</p>
                        <p class="text-slate-500 font-serif text-sm italic en-text border-l-2 border-yellow-200 pl-3">"${verse.text_en}"</p>
                    </div>

                    <!-- Dual Tracks -->
                    <div class="grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-yellow-100">
                        <!-- Academic -->
                        <div class="p-6 academic-box ${appState.studyFilter === 'devotional' ? 'hidden' : ''}">
                            <div class="flex items-center mb-3 text-slate-500">
                                <i class="fas fa-university mr-2"></i>
                                <h4 class="text-xs font-bold uppercase tracking-widest">经文含义 Exegesis</h4>
                            </div>
                            <h5 class="font-bold text-slate-700 mb-2">${academicTitle}</h5>
                            <p class="text-sm text-slate-600 leading-relaxed text-justify mb-2">${academicContentZh}</p>
                            <p class="text-xs text-slate-400 font-serif italic en-text border-t border-slate-300 pt-2 mt-2">${academicContentEn}</p>
                        </div>

                        <!-- Devotional -->
                        <div class="p-6 devotional-box ${appState.studyFilter === 'academic' ? 'hidden' : ''}">
                            <div class="flex items-center mb-3 text-orange-700">
                                <i class="fas fa-heart mr-2"></i>
                                <h4 class="text-xs font-bold uppercase tracking-widest">灵修应用 Devotional</h4>
                            </div>
                            <h5 class="font-bold text-orange-800 mb-2">${devotionalTitle}</h5>
                            <p class="text-sm text-orange-900/80 leading-relaxed text-justify mb-2">${devotionalContentZh}</p>
                            <p class="text-xs text-orange-700/70 font-serif italic en-text border-t border-orange-200 pt-2 mt-2">${devotionalContentEn}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderMethodology() {
            const container = document.getElementById('app-content');
            container.innerHTML = `
                <div class="max-w-4xl mx-auto">
                    <div class="text-center mb-10">
                        <h2 class="text-3xl font-bold mb-2 serif text-slate-800">解经方法论总结</h2>
                        <p class="text-slate-500 en-text">Summary of Exegetical Methodology</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Exegesis Card -->
                        <div class="bg-white p-8 rounded-xl shadow-lg border-t-4 border-slate-600 hover:shadow-xl transition hover:-translate-y-1">
                            <div class="text-slate-500 text-4xl mb-4"><i class="fas fa-book-reader"></i></div>
                            <h3 class="text-xl font-bold text-slate-700 mb-2">权威/经文性解经 (Exegesis)</h3>
                            <p class="text-xs text-slate-400 mb-6 uppercase tracking-wider">Typology & Context</p>
                            
                            <ul class="space-y-4 text-sm text-slate-600">
                                <li class="flex flex-col items-start">
                                    <div class="flex items-center font-bold text-yellow-600 mb-1"><i class="fas fa-check-circle mr-2"></i> 原则 Principles</div>
                                    <div class="mb-1">预表学（摩西/以利亚指向耶稣）。文化背景（半舍客勒税、芥菜种）。词源研究（小信vs不信）。</div>
                                    <div class="text-xs italic text-slate-400 en-text">Typology (Moses/Elijah pointing to Jesus). Cultural context (Temple tax). Etymology (Little faith vs Unbelief).</div>
                                </li>
                                <li class="flex flex-col items-start border-t border-slate-200 pt-3">
                                    <div class="flex items-center font-bold text-yellow-600 mb-1"><i class="fas fa-check-circle mr-2"></i> 如何运用 How to Apply</div>
                                    <div class="mb-1">将超自然事件（变像）视为对受苦的准备。理解耶稣作为"神的儿子"如何重新定义律法义务。</div>
                                    <div class="text-xs italic text-slate-400 en-text">View supernatural events as preparation for suffering. Understand Jesus as 'Son' redefining legal duties.</div>
                                </li>
                            </ul>
                        </div>

                        <!-- Devotional Card -->
                        <div class="bg-white p-8 rounded-xl shadow-lg border-t-4 border-orange-500 hover:shadow-xl transition hover:-translate-y-1">
                            <div class="text-orange-500 text-4xl mb-4"><i class="fas fa-pray"></i></div>
                            <h3 class="text-xl font-bold text-orange-800 mb-2">灵修/应用性解经 (Devotional)</h3>
                            <p class="text-xs text-orange-600/70 mb-6 uppercase tracking-wider">Glory & Valley</p>
                            
                            <ul class="space-y-4 text-sm text-slate-600">
                                <li class="flex flex-col items-start">
                                    <div class="flex items-center font-bold text-orange-600 mb-1"><i class="fas fa-check-circle mr-2"></i> 原则 Principles</div>
                                    <div class="mb-1">平衡高峰体验与山下现实。承认无能以获取能力。为了爱心放弃权利（不绊倒人）。</div>
                                    <div class="text-xs italic text-slate-400 en-text">Balancing peaks and valleys. Admitting powerlessness to gain power. Forfeiting rights for love (not offending).</div>
                                </li>
                                <li class="flex flex-col items-start border-t border-orange-100 pt-3">
                                    <div class="flex items-center font-bold text-orange-600 mb-1"><i class="fas fa-check-circle mr-2"></i> 如何运用 How to Apply</div>
                                    <div class="mb-1">不要企图住在山上，要带着光下山。面对顽疾时，检查信心并禁食祷告。</div>
                                    <div class="text-xs italic text-slate-400 en-text">Don't try to stay on the mountain; bring the light down. When stuck, check faith and fast/pray.</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }

        function updateFilter(filter) {
            appState.studyFilter = filter;
            renderStudy();
        }
    </script>
</body>
</html>