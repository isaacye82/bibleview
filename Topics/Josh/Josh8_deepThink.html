<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>约书亚记第8章：从失败到得胜的属灵蓝图</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap');
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f5f5f4; /* warm neutral stone-100 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 350px;
            margin: 0 auto;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .tab-active {
            border-bottom: 2px solid #b45309; /* amber-700 */
            color: #78350f; /* amber-900 */
            font-weight: 600;
        }
        .step-connector {
            position: absolute;
            left: 50%;
            top: 100%;
            height: 2rem;
            width: 2px;
            background-color: #d6d3d1;
            transform: translateX(-50%);
            z-index: 0;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals (Stone/Sand) with Amber/Deep Blue Accents for Spiritual/Royal themes -->
    <!-- Application Structure Plan: 
         1. Header & Context: Sets the stage (Post-Ai defeat).
         2. Dashboard - Strategic Insight (The Core): 
            - Left: Interactive Doughnut Chart showing thematic weight (Obedience, Strategy, Worship).
            - Right: Dynamic Comparison Chart (Jericho vs. Ai) illustrating God's varied methods.
         3. Narrative Flow - The Ambush: A step-by-step interactive timeline explaining the "Why" behind the military tactic.
         4. Covenant Renewal: Interactive dual-panel for Mt. Ebal and Gerizim (Blessing/Curse balance).
         5. Modern Application Generator: Input-output section for personalizing the scripture.
         Rationale: This structure moves from high-level abstract themes to concrete narrative details, then to theological significance, and finally to personal application, mirroring the process of "Observation, Interpretation, Application". 
    -->
    <!-- Visualization & Content Choices:
         - Thematic Doughnut Chart: To visualize the balance of spiritual components in the chapter. Interaction reveals text details.
         - Comparison Bar Chart: To clearly contrast the "Passive Miracle" of Jericho vs. the "Active Partnership" of Ai. No SVG needed.
         - Application Generator: Simple JS logic to map user states to specific verses/insights.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="text-stone-800 antialiased pb-12">

    <!-- Navigation / Header -->
    <header class="bg-white border-b border-stone-200 shadow-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <span class="text-2xl">📜</span>
                <h1 class="text-xl font-bold text-stone-900 tracking-tight">约书亚记 8: 得胜的蓝图</h1>
            </div>
            <nav class="hidden md:flex space-x-8 text-sm font-medium text-stone-500">
                <a href="#analysis" class="hover:text-amber-700 transition-colors">属灵分析</a>
                <a href="#strategy" class="hover:text-amber-700 transition-colors">神圣战略</a>
                <a href="#covenant" class="hover:text-amber-700 transition-colors">圣约更新</a>
                <a href="#application" class="hover:text-amber-700 transition-colors">今日应用</a>
            </nav>
        </div>
    </header>

    <!-- Intro Section -->
    <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
        <div class="bg-white rounded-xl p-8 shadow-sm border border-stone-100">
            <h2 class="text-2xl font-bold text-stone-900 mb-4">从亚割谷到以巴路山：复兴的旅程</h2>
            <p class="text-lg text-stone-600 leading-relaxed mb-6">
                约书亚记第8章记载了以色列人在经历了第7章艾城的惨痛失败（因亚干的罪）后，如何通过悔改、重新聆听神的策略，并彻底顺服，最终取得胜利并在以巴路山重申圣约的故事。这一章不仅仅是军事记录，更是一幅属灵复兴的路线图，教导我们如何在失败后重新站立。
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                <div class="p-4 bg-stone-50 rounded-lg">
                    <div class="text-3xl mb-2">🛡️</div>
                    <div class="font-bold text-stone-700">不要惧怕</div>
                    <div class="text-sm text-stone-500">神恢复了同在与应许</div>
                </div>
                <div class="p-4 bg-stone-50 rounded-lg">
                    <div class="text-3xl mb-2">⚔️</div>
                    <div class="font-bold text-stone-700">设下伏兵</div>
                    <div class="text-sm text-stone-500">信心与行动的结合</div>
                </div>
                <div class="p-4 bg-stone-50 rounded-lg">
                    <div class="text-3xl mb-2">⚖️</div>
                    <div class="font-bold text-stone-700">宣读律法</div>
                    <div class="text-sm text-stone-500">回归真理的根基</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Dashboard: Analysis & Comparison -->
    <div id="analysis" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8">
        
        <!-- Section Intro -->
        <div class="mb-4">
            <h3 class="text-xl font-bold text-stone-900 border-l-4 border-amber-600 pl-3">属灵深度分析仪表板</h3>
            <p class="mt-2 text-stone-600">
                本部分通过数据可视化分析本章的四大核心属灵主题，并对比耶利哥战役与艾城战役的不同，揭示神工作的多面性。
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- Insight 1: Thematic Distribution -->
            <div class="bg-white rounded-xl shadow-sm border border-stone-200 p-6">
                <h4 class="text-lg font-semibold text-stone-800 mb-4">本章属灵主题权重分析</h4>
                <div class="chart-container">
                    <canvas id="thematicChart"></canvas>
                </div>
                <div id="thematic-detail" class="mt-6 p-4 bg-amber-50 rounded-lg border border-amber-100 min-h-[100px] transition-all duration-300">
                    <p class="text-amber-900 font-medium text-center">👇 点击图表区块查看详细属灵洞见</p>
                </div>
            </div>

            <!-- Insight 2: Jericho vs Ai Comparison -->
            <div class="bg-white rounded-xl shadow-sm border border-stone-200 p-6">
                <h4 class="text-lg font-semibold text-stone-800 mb-4">神作工模式的对比：耶利哥 vs 艾城</h4>
                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
                <div class="mt-6 space-y-2 text-sm text-stone-600">
                    <p><strong class="text-stone-800">耶利哥模式：</strong> 显性的神迹，人只需顺服绕城，墙垣自动倒塌。强调神的<span class="text-amber-700">大能</span>。</p>
                    <p><strong class="text-stone-800">艾城模式：</strong> 隐性的神迹，人需要设伏、诱敌、作战。神借着人的<span class="text-amber-700">智慧与策略</span>得胜。</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Strategy Section: The Ambush -->
    <section id="strategy" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <h3 class="text-xl font-bold text-stone-900 border-l-4 border-sky-700 pl-3 mb-6">神圣战略：信心的每一步</h3>
        <p class="mb-8 text-stone-600 max-w-3xl">
            在艾城之战中，神没有叫墙倒塌，而是吩咐约书亚"在城后设下伏兵"。这教导我们，属灵争战不总是被动的等待神迹，有时需要精心的策划和极大的勇气。点击下方步骤查看详情。
        </p>

        <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
            <!-- Left: Interactive List -->
            <div class="md:col-span-5 space-y-3" id="strategy-steps">
                <!-- JS will populate interactive buttons here -->
            </div>

            <!-- Right: Display Area -->
            <div class="md:col-span-7 bg-white p-8 rounded-xl shadow-md border border-stone-200 flex flex-col justify-center min-h-[300px]">
                <div id="strategy-display-icon" class="text-5xl mb-4 text-center">🧠</div>
                <h4 id="strategy-display-title" class="text-2xl font-bold text-stone-800 mb-3 text-center">选择左侧步骤</h4>
                <p id="strategy-display-text" class="text-stone-600 text-lg leading-relaxed text-center">
                    探索神在约书亚记第8章中赐下的具体战术安排及其背后的属灵原则。
                </p>
                <div id="strategy-display-verse" class="mt-6 pt-4 border-t border-stone-100 text-sm text-stone-500 italic text-center">
                    --
                </div>
            </div>
        </div>
    </section>

    <!-- Covenant Section: Ebal & Gerizim -->
    <section id="covenant" class="bg-stone-100 py-16 border-y border-stone-200">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-10">
                <span class="text-3xl block mb-2">🏔️</span>
                <h3 class="text-2xl font-bold text-stone-900">得胜后的首要之事：筑坛与宣读</h3>
                <p class="text-stone-600 mt-2 max-w-2xl mx-auto">
                    约书亚在得胜后没有立即庆祝或继续征服，而是停下来筑坛敬拜。这表明：<br><strong>与神的关系比为神做工更重要。</strong>
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Mt Ebal Card -->
                <div class="bg-white rounded-lg p-6 border-t-4 border-stone-500 shadow-sm relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                        <span class="text-6xl">🌑</span>
                    </div>
                    <h4 class="text-xl font-bold text-stone-800 mb-2">以巴路山 (Mount Ebal)</h4>
                    <span class="inline-block px-2 py-1 bg-stone-100 text-xs font-semibold text-stone-600 rounded mb-4">宣布咒诅</span>
                    <ul class="space-y-3 text-stone-600">
                        <li class="flex items-start"><span class="mr-2 mt-1 text-xs">⚫</span> <span><strong>筑坛之处：</strong> 即使在宣布咒诅的山上，神也预备了祭坛（救恩）。</span></li>
                        <li class="flex items-start"><span class="mr-2 mt-1 text-xs">⚫</span> <span><strong>未凿过的石头：</strong> 象征人的工不能加添神的救恩，完全是恩典。</span></li>
                        <li class="flex items-start"><span class="mr-2 mt-1 text-xs">⚫</span> <span><strong>属灵意义：</strong> 承认我们无法靠行为称义，必须依赖祭牲（基督）的流血。</span></li>
                    </ul>
                </div>

                <!-- Mt Gerizim Card -->
                <div class="bg-white rounded-lg p-6 border-t-4 border-amber-500 shadow-sm relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                        <span class="text-6xl">☀️</span>
                    </div>
                    <h4 class="text-xl font-bold text-stone-800 mb-2">基利心山 (Mount Gerizim)</h4>
                    <span class="inline-block px-2 py-1 bg-amber-50 text-xs font-semibold text-amber-700 rounded mb-4">宣布祝福</span>
                    <ul class="space-y-3 text-stone-600">
                        <li class="flex items-start"><span class="mr-2 mt-1 text-xs">🟠</span> <span><strong>顺服之福：</strong> 提醒百姓，蒙福的途径在于听从神的话语。</span></li>
                        <li class="flex items-start"><span class="mr-2 mt-1 text-xs">🟠</span> <span><strong>全面的话语：</strong> 约书亚宣读律法上"祝福和咒诅的话"，没有删减。</span></li>
                        <li class="flex items-start"><span class="mr-2 mt-1 text-xs">🟠</span> <span><strong>属灵意义：</strong> 真理必须是完整的。我们不能只听喜欢的祝福，而忽略对罪的警告。</span></li>
                    </ul>
                </div>
            </div>
            
            <div class="mt-8 bg-stone-800 text-stone-200 p-6 rounded-lg text-center">
                <p class="font-serif italic text-lg">"随后约书亚将律法上祝福、咒诅的话，照着律法书上一切所写的，都宣读了一遍。" (8:34)</p>
            </div>
        </div>
    </section>

    <!-- Modern Application Generator -->
    <section id="application" class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <h3 class="text-xl font-bold text-stone-900 border-l-4 border-green-700 pl-3 mb-6">今日应用：你现在的光景如何？</h3>
        <p class="text-stone-600 mb-8">
            圣经是活泼的。选择你当前最接近的心境或处境，获取来自约书亚记第8章的属灵处方。
        </p>

        <div class="bg-white rounded-xl shadow-lg border border-stone-200 overflow-hidden">
            <div class="p-6 bg-stone-50 border-b border-stone-200">
                <label class="block text-sm font-medium text-stone-700 mb-3">我现在感到...</label>
                <div class="flex flex-wrap gap-3" id="mood-selector">
                    <!-- Buttons generated by JS -->
                </div>
            </div>
            
            <div class="p-8">
                <div id="app-result" class="opacity-0 transition-opacity duration-500">
                    <h4 id="app-title" class="text-2xl font-bold text-amber-700 mb-2">请选择上方的一个选项</h4>
                    <div class="h-1 w-20 bg-stone-200 mb-4 rounded"></div>
                    <p id="app-content" class="text-stone-700 text-lg leading-relaxed mb-6">
                        点击按钮开始探索神的话语如何应用在你今天的处境中。
                    </p>
                    <div id="app-action" class="bg-amber-50 border-l-4 border-amber-500 p-4 text-amber-900">
                        <p class="font-bold">行动建议：</p>
                        <p id="app-action-text">...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-stone-900 text-stone-400 py-8 mt-12">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <p class="mb-2">© 2023 约书亚记第8章 互动研读</p>
            <p class="text-xs text-stone-600">Designed for Spiritual Reflection & Application</p>
        </div>
    </footer>

    <script>
        // --- Data & State Management ---

        const themeData = {
            labels: ['战术策略 (Strategy)', '顺服与执行 (Obedience)', '敬拜与圣约 (Worship)', '完全的得胜 (Victory)'],
            data: [30, 25, 25, 20],
            details: [
                "<strong>战术策略：</strong> 神不仅是神迹的神，也是策略的神。祂吩咐设伏（8:2），利用敌人的骄傲（8:6，以为以色列人像前次一样逃跑）。这教导我们在事奉和生活中，既要祷告，也要运用智慧和计划。",
                "<strong>顺服与执行：</strong> 约书亚伸出手里的短枪（8:18）直到城被攻取。这是一个彻底顺服的记号。得胜不在于拥有策略，而在于完全照着神的吩咐去行，不打折扣。",
                "<strong>敬拜与圣约：</strong> 战争的目的是为了敬拜。8:30-35 记载筑坛和宣读律法，占据了本章显著的篇幅。真正的成功不是攻城略地，而是与神关系的恢复和对真理的确认。",
                "<strong>完全的得胜：</strong> 这一次，神允许百姓取城中的财物（8:2），这表明神不是吝啬的神。得胜包括了对罪的审判（艾王被挂）和神赐予的恩典（战利品）。"
            ],
            colors: ['#d97706', '#4b5563', '#0f766e', '#b45309'] // amber-600, gray-600, teal-700, amber-700
        };

        const comparisonData = {
            labels: ['显性神迹 (Miracle)', '人的参与 (Human Effort)', '战术复杂度 (Tactics)', '风险系数 (Risk)', '事后处理 (Aftermath)'],
            datasets: [
                {
                    label: '耶利哥 (Jericho)',
                    data: [9, 2, 1, 8, 1], // High miracle, low effort, low tactics, strict ban
                    backgroundColor: 'rgba(15, 118, 110, 0.6)', // teal
                    borderColor: 'rgba(15, 118, 110, 1)',
                    borderWidth: 1
                },
                {
                    label: '艾城 (Ai)',
                    data: [4, 9, 8, 6, 8], // Less visible miracle, high effort, high tactics, loot allowed
                    backgroundColor: 'rgba(217, 119, 6, 0.6)', // amber
                    borderColor: 'rgba(217, 119, 6, 1)',
                    borderWidth: 1
                }
            ]
        };

        const strategySteps = [
            {
                id: 1,
                title: "神的命令",
                icon: "🗣️",
                text: "耶和华对约书亚说：'不要惧怕...你起来上艾城去...要在城后设下伏兵。' 神首先处理约书亚的恐惧，然后给出具体指示。",
                verse: "约书亚记 8:1-2"
            },
            {
                id: 2,
                title: "夜间部署",
                icon: "🌙",
                text: "约书亚挑选三万大能的勇士，夜间打发他们前往艾城西方埋伏。这是隐秘的预备工作，也是信心的行动。",
                verse: "约书亚记 8:3-9"
            },
            {
                id: 3,
                title: "诱敌出城",
                icon: "🏃",
                text: "约书亚和其余的兵丁在城前安营，次日早晨诈败逃跑。艾城王和百姓因骄傲轻敌，倾巢而出追赶，城门大开。",
                verse: "约书亚记 8:14-17"
            },
            {
                id: 4,
                title: "伸出短枪",
                icon: "🗡️",
                text: "耶和华吩咐约书亚向城伸出手里的短枪。这是一个攻击的信号，也是顺服的姿态。伏兵见状立刻夺城放火。",
                verse: "约书亚记 8:18-19"
            },
            {
                id: 5,
                title: "前后夹击",
                icon: "🔥",
                text: "艾城人回头见城中烟气冲天，便失去勇气。约书亚的军队转身攻击，伏兵也从城里出来，形成合围之势，大获全胜。",
                verse: "约书亚记 8:20-22"
            }
        ];

        const applications = [
            {
                mood: "经历失败 (Failed)",
                label: "我刚经历失败...",
                title: "失败不是终局",
                content: "约书亚记第7章是惨败，但第8章一开始神就说“不要惧怕”。你的失败（像艾城第一次战役）只要经过处理（悔改像处理亚干的罪），就可以成为过去。神愿意赐给你第二次机会。",
                action: "来到神面前，承认具体的过犯，不找借口。然后以此为起点，聆听神'重新开始'的指示。不要因为昨天的失败而放弃今天的争战。"
            },
            {
                mood: "感到恐惧 (Fearful)",
                label: "我对未来感到恐惧...",
                title: "神必同在",
                content: "神对约书亚说的第一句话就是'不要惧怕，也不要惊惶'。这种确据是建立在神已经把仇敌'交在你手中'的应许上。恐惧往往源于看环境（高大的城墙），而非看神的应许。",
                action: "每天早晨大声宣告神的应许。当你感到害怕时，提醒自己：这场争战的胜败不在于你的能力，而在于神的同在。"
            },
            {
                mood: "困惑不解 (Confused)",
                label: "我不清楚方向...",
                title: "寻求具体的策略",
                content: "神没有叫约书亚用攻打耶利哥的方法去攻打艾城。神是做新事的神。你现在的困惑可能源于你试图套用过去的经验，而不是寻求神当下特定的引导。",
                action: "停止盲目的忙碌。花时间安静，特别求问神：'对于这件事，你此时此刻的策略是什么？' 留意神给你的智慧和创意。"
            },
            {
                mood: "缺乏动力 (Lazy)",
                label: "我只想坐享其成...",
                title: "信心需要行动",
                content: "攻打艾城需要全军出动，需要夜间行军，需要诈败奔跑。神虽然应许得胜，但人必须尽上当尽的本分。懒惰的信心不是真信心。",
                action: "列出你目前拖延的一件难事。求神加给你力量，制定一个具体的行动计划，并立刻迈出第一步（哪怕是设伏兵这样隐秘的一步）。"
            },
            {
                mood: "骄傲自满 (Proud)",
                label: "我觉得我很稳...",
                title: "警惕属灵的骄傲",
                content: "艾城人之所以失败，是因为他们看轻了以色列人，以为可以像上次一样轻易取胜，结果连城门都没关。骄傲使人盲目，看不见潜伏的危机。",
                action: "在这个顺遂的季节，更要警醒祷告。检查生命中是否有'未关的城门'（破口）。将荣耀归给神，而不是夸耀自己的能力。"
            }
        ];

        // --- Chart Initialization ---

        function initCharts() {
            // Doughnut Chart - Thematic
            const ctxTheme = document.getElementById('thematicChart').getContext('2d');
            const themeChart = new Chart(ctxTheme, {
                type: 'doughnut',
                data: {
                    labels: themeData.labels,
                    datasets: [{
                        data: themeData.data,
                        backgroundColor: themeData.colors,
                        borderWidth: 0,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { padding: 20, font: { family: "'Noto Sans SC', sans-serif" } } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return ' ' + context.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    },
                    onClick: (e, elements) => {
                        if (elements.length > 0) {
                            const index = elements[0].index;
                            updateInsightBox(index);
                        }
                    }
                }
            });

            // Update insight box initially
            updateInsightBox(0);

            // Bar Chart - Comparison
            const ctxComp = document.getElementById('comparisonChart').getContext('2d');
            new Chart(ctxComp, {
                type: 'bar',
                data: comparisonData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: 10, title: { display: true, text: '强度/程度 (1-10)' } }
                    },
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            callbacks: {
                                afterBody: function(context) {
                                    return "数据为基于神学分析的估值";
                                }
                            }
                        }
                    }
                }
            });
        }

        // --- Interactive Functions ---

        function updateInsightBox(index) {
            const box = document.getElementById('thematic-detail');
            box.innerHTML = `<p class="text-stone-800 text-sm leading-relaxed">${themeData.details[index]}</p>`;
            // Slight highlight effect
            box.className = `mt-6 p-4 bg-white rounded-lg border-l-4 shadow-sm transition-all duration-300`;
            box.style.borderLeftColor = themeData.colors[index];
        }

        function renderStrategySteps() {
            const container = document.getElementById('strategy-steps');
            container.innerHTML = '';
            
            strategySteps.forEach((step, index) => {
                const btn = document.createElement('button');
                btn.className = `w-full text-left p-4 rounded-lg border border-stone-200 transition-all duration-200 flex items-center hover:bg-stone-50 focus:outline-none focus:ring-2 focus:ring-amber-500 ${index === 0 ? 'bg-amber-50 border-amber-300 shadow-sm ring-1 ring-amber-500' : 'bg-white'}`;
                btn.innerHTML = `
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-stone-100 flex items-center justify-center text-xl mr-4 border border-stone-200">${step.icon}</div>
                    <div>
                        <div class="font-bold text-stone-800">步骤 ${step.id}: ${step.title}</div>
                        <div class="text-xs text-stone-500 truncate w-48">${step.verse}</div>
                    </div>
                `;
                btn.onclick = () => {
                    // Reset styling
                    Array.from(container.children).forEach(child => {
                        child.className = 'w-full text-left p-4 rounded-lg border border-stone-200 transition-all duration-200 flex items-center hover:bg-stone-50 focus:outline-none bg-white';
                    });
                    // Active styling
                    btn.className = 'w-full text-left p-4 rounded-lg border border-amber-300 transition-all duration-200 flex items-center bg-amber-50 shadow-sm ring-1 ring-amber-500 focus:outline-none';
                    
                    updateStrategyDisplay(step);
                };
                container.appendChild(btn);
            });
            
            // Init first step
            updateStrategyDisplay(strategySteps[0]);
        }

        function updateStrategyDisplay(step) {
            document.getElementById('strategy-display-icon').textContent = step.icon;
            document.getElementById('strategy-display-title').textContent = step.title;
            document.getElementById('strategy-display-text').textContent = step.text;
            document.getElementById('strategy-display-verse').textContent = step.verse;
        }

        function renderApplicationGenerator() {
            const container = document.getElementById('mood-selector');
            const resultArea = document.getElementById('app-result');
            
            applications.forEach(app => {
                const btn = document.createElement('button');
                btn.className = "px-4 py-2 rounded-full border border-stone-300 text-stone-600 text-sm hover:bg-amber-50 hover:border-amber-400 hover:text-amber-700 transition-colors focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2";
                btn.textContent = app.label;
                btn.onclick = () => {
                    // Update UI
                    document.getElementById('app-title').textContent = app.title;
                    document.getElementById('app-content').textContent = app.content;
                    document.getElementById('app-action-text').textContent = app.action;
                    
                    // Show result with fade in
                    resultArea.style.opacity = '0';
                    setTimeout(() => {
                        resultArea.style.opacity = '1';
                    }, 100);

                    // Highlight active button
                    Array.from(container.children).forEach(b => b.classList.remove('bg-amber-600', 'text-white', 'border-transparent'));
                    btn.classList.add('bg-amber-600', 'text-white', 'border-transparent');
                    btn.classList.remove('text-stone-600', 'hover:bg-amber-50');
                };
                container.appendChild(btn);
            });
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
            renderStrategySteps();
            renderApplicationGenerator();
        });

    </script>
</body>
</html>